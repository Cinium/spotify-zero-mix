(this["webpackJsonpspotify-single-daily"]=this["webpackJsonpspotify-single-daily"]||[]).push([[0],{32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},56:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(18),c=n.n(r),s=(n(32),n(33),n(11)),o=n(19),i=n(20),u="https://cinium.github.io"===window.location.origin?"https://cinium.github.io/spotify-zero-mix":"http://localhost:3000",l=["playlist-read-private","playlist-modify-private","playlist-modify-public"].join("%20"),p={primary:{99:"#FFFBFE",95:"#F6EDFF",90:"#EADDFF",80:"#D0BCFF",70:"#B69DF8",60:"#9A82DB",50:"#7F67BE",40:"#6750A4",30:"#4F378B",20:"#381E72",10:"#21005D"},secondary:{99:"#FFFBFE",95:"#F6EDFF",90:"#E8DEF8",80:"#CCC2DC",70:"#B0A7C0",60:"#958DA5",50:"#7A7289",40:"#625B71",30:"#4A4458",20:"#332D41",10:"#1D192B"},tertiary:{99:"#FFFBFA",95:"#FFECF1",90:"#FFD8E4",80:"#EFB8C8",70:"#D29DAC",60:"#B58392",50:"#986977",40:"#7D5260",30:"#633B48",20:"#492532",10:"#31111D"},error:{99:"#FFFBF9",95:"#FCEEEE",90:"#F9DEDC",80:"#F2B8B5",70:"#EC928E",60:"#E46962",50:"#DC362E",40:"#B3261E",30:"#8C1D18",20:"#601410",10:"#410E0B"},neutral:{99:"#FFFBFE",95:"#F4EFF4",90:"#E6E1E5",80:"#C9C5CA",70:"#AEAAAE",60:"#939094",50:"#787579",40:"#605D62",30:"#484649",20:"#313033",10:"#1C1B1F"}},b=new(function(){function e(){Object(o.a)(this,e)}return Object(i.a)(e,[{key:"login",value:function(){console.log(u),window.location="".concat("https://accounts.spotify.com/authorize","?client_id=").concat("6f24e1aa19004f7cab42054a136c6efb","&redirect_uri=").concat(u,"&scope=").concat(l,"&response_type=token&show_dialog=true")}},{key:"getTokenDataFromUrl",value:function(e){var t=e.substring(1).split("&"),n={created:new Date};t.forEach((function(e){var t=e.split("="),a=Object(s.a)(t,2),r=a[0],c=a[1];n[r]=c})),localStorage.setItem("token",JSON.stringify(n))}},{key:"checkIfTokenExpired",value:function(){var e=JSON.parse(localStorage.getItem("token")),t=new Date(e.created);return Math.abs(((new Date).getTime()-t.getTime())/1e3)>3600}}]),e}()),f=(n(34),n(1));var h=function(){return Object(f.jsxs)("section",{className:"login",children:[Object(f.jsx)("h2",{className:"title",children:"\u0412\u043e\u0439\u0434\u0438 \u0432 Spotify"}),Object(f.jsx)("button",{onClick:b.login,className:"login__button button",children:"\u0412\u043e\u0439\u0442\u0438"})]})},d=n(12),j=n(16),v=n(3),y=n.n(v),m=n(4),O=n(8),x="SET_CURRENT_USER",g="IS_LOADING",k="DAILY_MIXES",_="ZERO_MIX",w="NEW_DAILY_MIX",F="IS_MOBILE",E="SUCCESS_MESSAGE";function S(e){return{type:g,payload:e}}function N(e){return{type:F,payload:e}}function A(e){return{type:E,payload:e}}var D=function(){function e(t){Object(o.a)(this,e),this.base_url=t}return Object(i.a)(e,[{key:"getTokenFromLocal",value:function(){if(localStorage.getItem("token"))return JSON.parse(localStorage.getItem("token"))}},{key:"getPlaylists",value:function(){var e=Object(m.a)(y.a.mark((function e(){var t,n,a,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getTokenFromLocal();case 2:return t=e.sent,e.next=5,fetch("".concat(this.base_url,"/v1/me/playlists"),{method:"GET",headers:{Authorization:"".concat(t.token_type," ").concat(t.access_token)}});case 5:return n=e.sent,e.next=8,n.json();case 8:return a=e.sent,e.next=11,a.items;case 11:return r=e.sent,e.abrupt("return",r);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getPlaylistItems",value:function(){var e=Object(m.a)(y.a.mark((function e(t,n){var a,r,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.getTokenFromLocal(),e.next=3,fetch("".concat(this.base_url,"/v1/playlists/").concat(t,"/tracks").concat(n?"?offset=".concat(n,"&limit=100"):""),{method:"GET",headers:{Authorization:"".concat(a.token_type," ").concat(a.access_token)}});case 3:return r=e.sent,e.next=6,r.json();case 6:return c=e.sent,e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getUserInfo",value:function(){var e=Object(m.a)(y.a.mark((function e(){var t,n,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getTokenFromLocal(),e.next=3,fetch("".concat(this.base_url,"/v1/me"),{method:"GET",headers:{Authorization:"".concat(t.token_type," ").concat(t.access_token)}});case 3:return n=e.sent,e.next=6,n.json();case 6:return a=e.sent,e.abrupt("return",a);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createPlaylist",value:function(){var e=Object(m.a)(y.a.mark((function e(t){var n,a,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getTokenFromLocal(),e.next=3,fetch("".concat(this.base_url,"/v1/users/").concat(t,"/playlists"),{method:"POST",headers:{Authorization:"".concat(n.token_type," ").concat(n.access_token),"Content-Type":"application/json"},body:JSON.stringify({name:"\u041c\u0438\u043a\u0441 \u0434\u043d\u044f #0",description:"All in one daily mix",public:!1})});case 3:return a=e.sent,r=a.json(),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addItemsToPlayList",value:function(){var e=Object(m.a)(y.a.mark((function e(t,n){var a,r,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.getTokenFromLocal(),e.next=3,fetch("".concat(this.base_url,"/v1/playlists/").concat(t,"/tracks"),{method:"POST",headers:{Authorization:"".concat(a.token_type," ").concat(a.access_token),"Content-Type":"application/json"},body:JSON.stringify({uris:n,position:0})});case 3:return r=e.sent,c=r.json(),e.abrupt("return",c);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteItemsFromPlaylist",value:function(){var e=Object(m.a)(y.a.mark((function e(t,n){var a,r,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.getTokenFromLocal(),e.next=3,fetch("".concat(this.base_url,"/v1/playlists/").concat(t,"/tracks"),{method:"DELETE",headers:{Authorization:"".concat(a.token_type," ").concat(a.access_token),"Content-Type":"application/json"},body:JSON.stringify({tracks:n})});case 3:return r=e.sent,c=r.json(),e.abrupt("return",c);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),C=new D("https://api.spotify.com");n(42);var T=function(){return Object(f.jsxs)("div",{className:"lds-ring",style:{marginTop:"150px"},children:[Object(f.jsx)("div",{}),Object(f.jsx)("div",{}),Object(f.jsx)("div",{}),Object(f.jsx)("div",{})]})};n(43);function I(){var e=Object(O.useSelector)((function(e){return e.user})),t=Object(O.useSelector)((function(e){return e.app.isLoading})),n=Object(O.useSelector)((function(e){return e.app.successMessage})),a=Object(O.useDispatch)();function r(){return(r=Object(m.a)(y.a.mark((function e(){var t,n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F()&&b.login(),a(S(!0)),e.prev=2,e.next=5,c();case 5:return t=e.sent,e.next=8,o(t);case 8:if(n=e.sent,!(r=t.find((function(e){return"\u041c\u0438\u043a\u0441 \u0434\u043d\u044f #0"===e.name})))){e.next=16;break}return e.next=13,u(r.id);case 13:g(r,n),e.next=20;break;case 16:return e.next=18,v();case 18:g(e.sent,n);case 20:a(A(!0)),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(2),console.log(e.t0);case 26:return e.prev=26,a(S(!1)),e.finish(26);case 29:case"end":return e.stop()}}),e,null,[[2,23,26,29]])})))).apply(this,arguments)}function c(){return s.apply(this,arguments)}function s(){return(s=Object(m.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.getPlaylists();case 3:return t=e.sent,e.abrupt("return",w(t));case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function o(e){return i.apply(this,arguments)}function i(){return(i=Object(m.a)(y.a.mark((function e(t){var n,a,r,c,s,o;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=[],a=Object(j.a)(t),e.prev=3,a.s();case 5:if((r=a.n()).done){e.next=15;break}if("\u041c\u0438\u043a\u0441 \u0434\u043d\u044f #0"===(c=r.value).name){e.next=13;break}return e.next=10,C.getPlaylistItems(c.id);case 10:s=e.sent,o=s.items,n=n.concat(o);case 13:e.next=5;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(3),a.e(e.t0);case 20:return e.prev=20,a.f(),e.finish(20);case 23:return e.abrupt("return",n);case 26:e.prev=26,e.t1=e.catch(0),console.log(e.t1);case 29:case"end":return e.stop()}}),e,null,[[0,26],[3,17,20,23]])})))).apply(this,arguments)}function u(e){return l.apply(this,arguments)}function l(){return(l=Object(m.a)(y.a.mark((function e(t){var n,a,r,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.getPlaylistItems(t);case 3:if(n=e.sent,a=Object(d.a)(n.items),!(n.total>n.items.length)){e.next=15;break}r=100;case 7:if(!(r<n.total)){e.next=15;break}return e.next=10,C.getPlaylistItems(t,r);case 10:c=e.sent,a=[].concat(Object(d.a)(a),Object(d.a)(c.items));case 12:r+=100,e.next=7;break;case 15:p(t,a),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.log(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})))).apply(this,arguments)}function p(e,t){return h.apply(this,arguments)}function h(){return(h=Object(m.a)(y.a.mark((function e(t,n){var a,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],n.forEach((function(e){return a=[].concat(Object(d.a)(a),[{uri:e.track.uri}])})),e.prev=2;case 3:if(!(a.length>0)){e.next=9;break}return r=a.splice(0,100),e.next=7,C.deleteItemsFromPlaylist(t,r);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})))).apply(this,arguments)}function v(){return x.apply(this,arguments)}function x(){return(x=Object(m.a)(y.a.mark((function t(){var n;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.createPlaylist(e.id);case 3:return n=t.sent,t.abrupt("return",n);case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}function g(e,t){return k.apply(this,arguments)}function k(){return(k=Object(m.a)(y.a.mark((function e(t,n){var a,r,c,s,o,i;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0;case 1:if(!(n.length>0)){e.next=12;break}r=[],a=n.splice(0,100),c=Object(j.a)(a);try{for(c.s();!(s=c.n()).done;)o=s.value,r.push(o.track.uri)}catch(u){c.e(u)}finally{c.f()}return e.next=8,C.addItemsToPlayList(t.id,_(r));case 8:i=e.sent,console.log(i),e.next=1;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}function _(e){for(var t,n=e.length;0!==n;){t=Math.floor(Math.random()*n),n--;var a=[e[t],e[n]];e[n]=a[0],e[t]=a[1]}return e}function w(e){return e.filter((function(e){return e.name.includes("\u041c\u0438\u043a\u0441 \u0434\u043d\u044f")}))}function F(){var e=JSON.parse(localStorage.getItem("token")),t=new Date(e.created);return Math.abs(((new Date).getTime()-t.getTime())/1e3)>3600}return Object(f.jsxs)("div",{className:"playlists",children:[Object(f.jsx)("h2",{className:"playlists__title title",children:"\u0412\u0440\u0435\u043c\u044f \u0433\u0435\u043d\u0435\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043b\u0435\u0439\u043b\u0438\u0441\u0442 \u0434\u043d\u044f!"}),t&&Object(f.jsx)(T,{}),n&&Object(f.jsx)("p",{style:{color:"#B3261E",fontSize:"20px"},children:"\u041f\u043b\u0435\u0439\u043b\u0438\u0441\u0442 \u0441\u043e\u0437\u0434\u0430\u043d!"}),Object(f.jsx)("button",{onClick:function(){return r.apply(this,arguments)},disabled:!!t,className:"playlists__create-button button ".concat(t&&"button_disabled"),children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u043b\u0435\u0439\u043b\u0438\u0441\u0442"})]})}var B=n(2),L=n(9);n(44);var M=function(){return Object(f.jsxs)("ul",{className:"navbar",children:[Object(f.jsx)("li",{className:"navbar__item",children:Object(f.jsx)(L.b,{to:"/about",className:function(e){return"navbar__link"+(e.isActive?" navbar__link_active":"")},children:"About"})}),Object(f.jsx)("li",{className:"navbar__item",children:Object(f.jsx)(L.b,{to:"/",className:function(e){return"navbar__link"+(e.isActive?" navbar__link_active":"")},children:"Login"})}),Object(f.jsx)("li",{className:"navbar__item",children:Object(f.jsx)(L.b,{to:"/playlists",className:function(e){return"navbar__link"+(e.isActive?" navbar__link_active":"")},children:"Generate"})})]})};n(45);var P=function(){var e,t=Object(O.useSelector)((function(e){return e.user.user}));return Object(f.jsx)("div",{className:"avatar",children:0!==(null===t||void 0===t||null===(e=t.images)||void 0===e?void 0:e.length)?Object(f.jsx)("img",{src:t.images.large,alt:"user pic"}):Object(f.jsx)("span",{children:t.display_name.slice(0,1)})})};n(46);var z=function(){var e=Object(O.useSelector)((function(e){return e.user.user}));return Object(f.jsxs)("header",{className:"header",style:{backgroundColor:p.secondary[95]},children:["Spotify Zero Mix",(null===e||void 0===e?void 0:e.images)&&Object(f.jsx)(P,{})]})};n(47);var J=function(){return Object(a.useEffect)((function(){var e=Object(d.a)(document.querySelector(".mobilenav").querySelectorAll("span"));switch(window.location.pathname){case"/about":e.forEach((function(e){e.style.backgroundColor="info"===e.textContent?p.secondary[90]:"transparent"}));break;case"":case"/":e.forEach((function(e){e.style.backgroundColor="login"===e.textContent?p.secondary[90]:"transparent"}));break;case"/playlists":e.forEach((function(e){e.style.backgroundColor="add_circle"===e.textContent?p.secondary[90]:"transparent"}))}})),Object(f.jsxs)("ul",{className:"mobilenav",style:{backgroundColor:p.secondary[95]},children:[Object(f.jsxs)(L.b,{to:"/about",className:function(e){return"mobilenav__link"+(e.isActive?" active":"")},style:function(e){return{color:e.isActive?p.secondary[10]:p.neutral[30]}},children:[Object(f.jsx)("span",{className:"material-icons",children:"info"}),Object(f.jsx)("label",{className:"mobilenav__label",children:"About"})]}),Object(f.jsxs)(L.b,{to:"/",className:function(e){return"mobilenav__link"+(e.isActive?" active":"")},style:function(e){return{color:e.isActive?p.secondary[10]:p.neutral[30]}},children:[Object(f.jsx)("span",{className:"material-icons",children:"login"}),Object(f.jsx)("label",{className:"mobilenav__label",children:"Login"})]}),Object(f.jsxs)(L.b,{to:"/playlists",className:function(e){return"mobilenav__link"+(e.isActive?" active":"")},style:function(e){return{color:e.isActive?p.secondary[10]:p.neutral[30]}},children:[Object(f.jsx)("span",{className:"material-icons",children:"add_circle"}),Object(f.jsx)("label",{className:"mobilenav__label",children:"Generate"})]})]})};var R=function(){var e=Object(B.useNavigate)(),t=Object(O.useDispatch)(),n=Object(O.useSelector)((function(e){return e.app.isMobile}));function r(){window.screen.width<=424?t(N(!0)):t(N(!1))}return Object(a.useEffect)((function(){console.log("/spotify-zero-mix"===window.location.pathname),r(),document.querySelector('meta[name="theme-color"]').setAttribute("content",p.secondary[90]),window.addEventListener("resize",r),"/spotify-zero-mix"===window.location.pathname&&e("/"),window.location.hash&&(b.getTokenDataFromUrl(window.location.hash),t(function(){var e=Object(m.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.getUserInfo();case 3:n=e.sent,localStorage.setItem("user",JSON.stringify(n)),t({type:x,payload:n}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()),e("/playlists"))}),[]),Object(f.jsxs)("div",{className:"App",children:[Object(f.jsx)(z,{}),!n&&Object(f.jsx)(M,{}),Object(f.jsxs)(B.Routes,{children:[Object(f.jsx)(B.Route,{path:"/",element:Object(f.jsx)(h,{})}),Object(f.jsx)(B.Route,{path:"playlists",element:Object(f.jsx)(I,{})})]}),n&&Object(f.jsx)(J,{})]})},G=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,57)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))},U=n(14),q=n(25),X=n(27),W=n(26),Y=n(7),Z=Object(Y.b)(),H=n(5),K=JSON.parse(localStorage.getItem("user")),Q=K?{user:K}:{};var V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;return t.type===x?Object(H.a)(Object(H.a)({},e),{},{user:t.payload}):e},$={isLoading:!1};var ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return Object(H.a)(Object(H.a)({},e),{},{isLoading:t.payload});case F:return Object(H.a)(Object(H.a)({},e),{},{isMobile:t.payload});case E:return Object(H.a)(Object(H.a)({},e),{},{successMessage:t.payload});default:return e}};var te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:return Object(H.a)(Object(H.a)({},e),{},{dailyMixes:t.payload});case _:return Object(H.a)(Object(H.a)({},e),{},{zeroMix:t.payload});case w:return Object(H.a)(Object(H.a)({},e),{},{newDailyMix:t.payload});default:return e}},ne=Object(U.combineReducers)({router:Object(W.connectRouter)(Z),user:V,app:ee,playlists:te}),ae=Object(U.createStore)(ne,Object(q.composeWithDevTools)(Object(U.applyMiddleware)(X.a)));document.querySelector("body").style.backgroundColor=p.neutral[99],c.a.render(Object(f.jsx)(O.Provider,{store:ae,children:Object(f.jsx)(L.a,{children:Object(f.jsx)(R,{})})}),document.getElementById("root")),G()}},[[56,1,2]]]);
//# sourceMappingURL=main.6ff19c8b.chunk.js.map